{"version":3,"file":"vue.js","sources":["../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["//我们希望重写数组中的部分方法\r\n\r\nlet oldArrayProto = Array.prototype //获取数组的原型\r\n\r\n//newArrayProto.__proto__ = oldArrayProto\r\nexport let newArrayProto = Object.create(oldArrayProto)\r\n\r\nlet methods = [ //找到所有的变异方法\r\n  'push',\r\n  'pop',\r\n  'unshift',\r\n  'shift',\r\n  'sort',\r\n  'reverse',\r\n  'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  newArrayProto[method] = function (...args) { //这里重写了数组的方法\r\n    const result = oldArrayProto[method].apply(this, args)\r\n\r\n    console.log('method', method);\r\n    return result\r\n  }\r\n})","import {newArrayProto} from './array'\r\nclass Observe{\r\n  constructor(data){\r\n    if (Array.isArray(data)) {\r\n      //这里我们可以重写数组中的方法， 7个编译方法，是可以修改数组本身的\r\n      data.__proto__ = newArrayProto\r\n    }else{\r\n      this.walk(data)\r\n    }\r\n  }\r\n\r\n  walk(data){\r\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]))\r\n  }\r\n  observeArray(data){ //观测数组的值\r\n    data.forEach(item => observe(item))\r\n  }\r\n}\r\n\r\n\r\nexport function defineReactive(target, key, value) {\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      console.log('劫持用户的取值操作，get',key);\r\n      return value\r\n    },\r\n    set(newValue){\r\n      if (newValue !== value) {\r\n      console.log('劫持用户的设置操作，set');\r\n        value = newValue\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function observe(data) {\r\n  if (typeof data !== 'object' || data === null) {\r\n    return\r\n  }\r\n  return new Observe(data)\r\n}","import {observe} from './observe'\r\n\r\nexport  function initState(vm) {\r\n  const opts = vm.$options\r\n  // if (opts.props) {\r\n  //   initProps(opts.props)\r\n  // }\r\n\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n}\r\n\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data\r\n  data = typeof data === 'function'? data.call(vm) : data\r\n  vm._data = data\r\n\r\n  observe(data)\r\n} ","import {initState} from \"./state\"\r\n\r\n function initMixin(Vue){\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this\r\n    vm.$options = options // 将用户的选项存在实例上\r\n    initState(vm)\r\n  }\r\n}\r\n\r\nexport default initMixin","import initMixin from \"./init\"\r\n\r\n\r\nfunction Vue(options) {\r\n  this._init(options)\r\n}\r\n\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","result","apply","console","log","Observe","data","isArray","__proto__","walk","keys","key","defineReactive","item","observe","target","value","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","call","_data","initMixin","Vue","_init","options"],"mappings":"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"}